<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Film Manager Pro - –ó–∞–º–µ—Ä</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f8f9fa;
    }
    
    .header {
      display: flex;
      align-items: center;
      padding: 15px;
      background-color: #fff;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }
    
    .back-button {
      margin-right: 15px;
      cursor: pointer;
    }
    
    .page-title {
      font-weight: bold;
      font-size: 18px;
    }
    
    .container {
      max-width: 800px;
      margin: 20px auto;
      padding: 0 15px;
    }
    
    .section-title {
      font-weight: bold;
      margin-bottom: 10px;
    }
    
    .manual-input {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }
    
    .input-field {
      flex: 1;
    }
    
    .input-field input {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 16px;
      box-sizing: border-box;
    }
    
    .ok-button {
      padding: 10px 20px;
      background-color: #4285F4;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 16px;
      cursor: pointer;
    }
    
    .quick-input {
      margin-bottom: 20px;
    }
    
    .quick-input textarea {
      width: 100%;
      min-height: 100px;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 16px;
      box-sizing: border-box;
      resize: vertical;
    }
    
    .details-list {
      margin-bottom: 20px;
    }
    
    .detail-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      background-color: white;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-bottom: 5px;
    }
    
    .detail-icon {
      margin-right: 10px;
    }
    
    .detail-size {
      flex-grow: 1;
    }
    
    .detail-actions {
      display: flex;
      gap: 5px;
    }
    
    .edit-icon, .delete-icon {
      cursor: pointer;
      color: #666;
    }
    
    .summary {
      background-color: white;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 15px;
      margin-bottom: 20px;
    }
    
    .summary-item {
      margin-bottom: 5px;
    }
    
    .cutting-map {
      background-color: white;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 15px;
      text-align: center;
    }
    
    .progress-bar {
      height: 20px;
      background-color: #e9ecef;
      border-radius: 10px;
      margin-bottom: 5px;
      overflow: hidden;
    }
    
    .progress {
      height: 100%;
      background-color: #4285F4;
      width: 85%;
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="back-button">‚Üê</div>
    <div class="page-title">–ö–∞—á–∞–Ω –î.–Æ. –ó–∞–º–µ—Ä –æ–∫–æ–Ω</div>
  </div>
  
  <div class="container">
    <div class="section-title">üè† –†—É—á–Ω–æ–π –≤–≤–æ–¥:</div>
    <div class="manual-input">
      <div class="input-field">
        <input type="number" id="width" placeholder="–®–∏—Ä–∏–Ω–∞" min="1">
      </div>
      <div class="input-field">
        <input type="number" id="height" placeholder="–í—ã—Å–æ—Ç–∞" min="1">
      </div>
      <div class="input-field">
        <input type="number" id="quantity" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ" min="1" value="1">
      </div>
      <button class="ok-button">OK</button>
    </div>
    
    <div class="section-title">üìù –ë—ã—Å—Ç—Ä—ã–π –≤–≤–æ–¥ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):</div>
    <div class="quick-input">
      <textarea id="quick-input" placeholder="—à–∏—Ä–∏–Ω–∞,–≤—ã—Å–æ—Ç–∞,–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 800,600,2)"></textarea>
    </div>
    
    <div class="section-title">üìä –°–ø–∏—Å–æ–∫ –¥–µ—Ç–∞–ª–µ–π:</div>
    <div class="details-list" id="details-list">
      <div class="detail-item">
        <div class="detail-icon">[‚ñ¨‚ñ¨]</div>
        <div class="detail-size">800√ó600√ó2 = 0.96–º¬≤</div>
        <div class="detail-actions">
          <div class="edit-icon">‚úèÔ∏è</div>
          <div class="delete-icon">‚ùå</div>
        </div>
      </div>
      <div class="detail-item">
        <div class="detail-icon">[|]</div>
        <div class="detail-size">1200√ó800√ó1 = 0.96–º¬≤</div>
        <div class="detail-actions">
          <div class="edit-icon">‚úèÔ∏è</div>
          <div class="delete-icon">‚ùå</div>
        </div>
      </div>
      <div class="detail-item">
        <div class="detail-icon">[‚ñ¨]</div>
        <div class="detail-size">600√ó400√ó3 = 0.72–º¬≤</div>
        <div class="detail-actions">
          <div class="edit-icon">‚úèÔ∏è</div>
          <div class="delete-icon">‚ùå</div>
        </div>
      </div>
    </div>
    
    <div class="section-title">üìà –°–≤–æ–¥–∫–∞:</div>
    <div class="summary">
      <div class="summary-item">‚Ä¢ –î–µ—Ç–∞–ª–µ–π: 6</div>
      <div class="summary-item">‚Ä¢ –û–±—â–∞—è –ø–ª–æ—â–∞–¥—å: 2.64 –º¬≤</div>
      <div class="summary-item">‚Ä¢ –†—É–ª–æ–Ω: 3.2 –º–ø (4.9 –º¬≤)</div>
    </div>
    
    <div class="cutting-map">
      <div class="progress-bar">
        <div class="progress"></div>
      </div>
      –ú–∏–Ω–∏-–∫–∞—Ä—Ç–∞ —Ä–∞—Å–∫—Ä–æ—è<br>
      85% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
    </div>
  </div>
  
  <script>
    // Back button functionality
    document.querySelector('.back-button').addEventListener('click', function() {
      window.location.href = 'client-details.html';
    });
    
    // Manual input functionality
    document.querySelector('.ok-button').addEventListener('click', function() {
      const width = document.getElementById('width').value;
      const height = document.getElementById('height').value;
      const quantity = document.getElementById('quantity').value;
      
      if (width && height && quantity) {
        addDetail(width, height, quantity);
        
        // Clear inputs
        document.getElementById('width').value = '';
        document.getElementById('height').value = '';
        document.getElementById('quantity').value = '1';
      } else {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
      }
    });
    
    // Quick input functionality
    document.getElementById('quick-input').addEventListener('blur', function() {
      const lines = this.value.split('\n');
      
      lines.forEach(line => {
        const parts = line.split(',');
        if (parts.length === 3) {
          const width = parts[0].trim();
          const height = parts[1].trim();
          const quantity = parts[2].trim();
          
          if (width && height && quantity) {
            addDetail(width, height, quantity);
          }
        }
      });
      
      // Clear the textarea
      this.value = '';
    });
    
    // Edit and delete functionality
    document.querySelectorAll('.edit-icon').forEach(icon => {
      icon.addEventListener('click', function() {
        const detailItem = this.closest('.detail-item');
        const sizeText = detailItem.querySelector('.detail-size').textContent;
        
        // Parse the size text to get width, height, and quantity
        const matches = sizeText.match(/(\d+)√ó(\d+)√ó(\d+)/);
        if (matches) {
          const width = matches[1];
          const height = matches[2];
          const quantity = matches[3];
          
          // Fill in the manual input fields
          document.getElementById('width').value = width;
          document.getElementById('height').value = height;
          document.getElementById('quantity').value = quantity;
          
          // Remove the detail item
          detailItem.remove();
          
          // Update summary
          updateSummary();
        }
      });
    });
    
    document.querySelectorAll('.delete-icon').forEach(icon => {
      icon.addEventListener('click', function() {
        const detailItem = this.closest('.detail-item');
        detailItem.remove();
        
        // Update summary
        updateSummary();
      });
    });
    
    // Helper function to add a detail
    function addDetail(width, height, quantity) {
      const area = (width * height * quantity) / 1000000; // Convert to m¬≤
      
      const detailItem = document.createElement('div');
      detailItem.className = 'detail-item';
      
      const icon = width > height ? '[‚ñ¨‚ñ¨]' : '[|]';
      
      detailItem.innerHTML = `
        <div class="detail-icon">${icon}</div>
        <div class="detail-size">${width}√ó${height}√ó${quantity} = ${area.toFixed(2)}–º¬≤</div>
        <div class="detail-actions">
          <div class="edit-icon">‚úèÔ∏è</div>
          <div class="delete-icon">‚ùå</div>
        </div>
      `;
      
      // Add event listeners to the new edit and delete icons
      detailItem.querySelector('.edit-icon').addEventListener('click', function() {
        const sizeText = this.closest('.detail-item').querySelector('.detail-size').textContent;
        
        const matches = sizeText.match(/(\d+)√ó(\d+)√ó(\d+)/);
        if (matches) {
          document.getElementById('width').value = matches[1];
          document.getElementById('height').value = matches[2];
          document.getElementById('quantity').value = matches[3];
          
          this.closest('.detail-item').remove();
          updateSummary();
        }
      });
      
      detailItem.querySelector('.delete-icon').addEventListener('click', function() {
        this.closest('.detail-item').remove();
        updateSummary();
      });
      
      document.getElementById('details-list').appendChild(detailItem);
      
      // Update summary
      updateSummary();
    }
    
    // Helper function to update the summary
    function updateSummary() {
      const detailItems = document.querySelectorAll('.detail-item');
      
      let totalPieces = 0;
      let totalArea = 0;
      
      detailItems.forEach(item => {
        const sizeText = item.querySelector('.detail-size').textContent;
        
        const matches = sizeText.match(/(\d+)√ó(\d+)√ó(\d+) = ([\d.]+)–º¬≤/);
        if (matches) {
          const quantity = parseInt(matches[3]);
          const area = parseFloat(matches[4]);
          
          totalPieces += quantity;
          totalArea += area;
        }
      });
      
      // Calculate roll length (simplified)
      const rollLength = Math.ceil(totalArea / 1.524 * 1000) / 1000; // Assuming 1524mm roll width
      const rollArea = rollLength * 1.524;
      
      const summary = document.querySelector('.summary');
      summary.innerHTML = `
        <div class="summary-item">‚Ä¢ –î–µ—Ç–∞–ª–µ–π: ${totalPieces}</div>
        <div class="summary-item">‚Ä¢ –û–±—â–∞—è –ø–ª–æ—â–∞–¥—å: ${totalArea.toFixed(2)} –º¬≤</div>
        <div class="summary-item">‚Ä¢ –†—É–ª–æ–Ω: ${rollLength.toFixed(1)} –º–ø (${rollArea.toFixed(1)} –º¬≤)</div>
      `;
      
      // Update usage percentage
      const usagePercentage = totalArea / rollArea * 100;
      document.querySelector('.progress').style.width = `${usagePercentage}%`;
      document.querySelector('.cutting-map').innerHTML = `
        <div class="progress-bar">
          <div class="progress" style="width: ${usagePercentage}%"></div>
        </div>
        –ú–∏–Ω–∏-–∫–∞—Ä—Ç–∞ —Ä–∞—Å–∫—Ä–æ—è<br>
        ${Math.round(usagePercentage)}% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
      `;
    }
  </script>
</body>
</html> 